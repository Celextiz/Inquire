<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Physiotherapy Inquire Form</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body { background:#f8f9fa; padding-top:32px; }
    .card { max-width:900px; margin:auto; }
    .required { color:#dc3545; margin-left:3px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card shadow-sm">
      <div class="card-body">
        <h3 class="card-title">Physiotherapy Inquire Form</h3>
        <p class="text-muted">Complete this form to start your therapy.</p>

        <form id="inquireForm" novalidate>
          <h6>Patient Information</h6>
          <div class="row g-2">
            <div class="col-md-4">
              <label class="form-label">First Name <span class="required">*</span></label>
              <input id="p_first" class="form-control" required />
            </div>
            <div class="col-md-4">
              <label class="form-label">Middle Name</label>
              <input id="p_middle" class="form-control" />
            </div>
            <div class="col-md-4">
              <label class="form-label">Last Name <span class="required">*</span></label>
              <input id="p_last" class="form-control" required />
            </div>
          </div>

          <div class="row g-2 mt-2">
            <div class="col-md-6">
              <label class="form-label">Email / Yahoo (optional)</label>
              <input id="p_email" class="form-control" type="email" />
            </div>
            <div class="col-md-6">
              <label class="form-label">Phone Number <span class="required">*</span></label>
              <input id="p_phone" class="form-control" type="tel" required />
            </div>
          </div>

          <div class="row g-2 mt-2">
            <div class="col-md-8">
              <label class="form-label">Address <span class="required">*</span></label>
              <input id="p_address" class="form-control" required />
            </div>
            <div class="col-md-4">
              <label class="form-label">Date of Birth <span class="required">*</span></label>
              <input id="p_dob" class="form-control" type="date" required />
            </div>
          </div>

          <div class="row g-2 mt-2">
            <div class="col-12">
              <label class="form-label">Case of Patient <span class="required">*</span></label>
              <input id="p_case" class="form-control" required placeholder="e.g., Low back pain, Stroke, Post-op knee" />
            </div>
          </div>

          <hr class="my-3" />
          <h6>Emergency Contact Information</h6>
          <div class="row g-2">
            <div class="col-md-6">
              <label class="form-label">First Name <span class="required">*</span></label>
              <input id="e_first" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Last Name <span class="required">*</span></label>
              <input id="e_last" class="form-control" required />
            </div>
          </div>

          <div class="row g-2 mt-2">
            <div class="col-md-6">
              <label class="form-label">Email / Yahoo (optional)</label>
              <input id="e_email" class="form-control" type="email" />
            </div>
            <div class="col-md-6">
              <label class="form-label">Phone Number <span class="required">*</span></label>
              <input id="e_phone" class="form-control" type="tel" required />
            </div>
          </div>

          <div class="row g-2 mt-2">
            <div class="col-md-6">
              <label class="form-label">Relation <span class="required">*</span></label>
              <input id="e_relation" class="form-control" required placeholder="e.g., Parent, Spouse" />
            </div>
          </div>

          <div class="mt-4 d-flex gap-2">
            <button type="submit" class="btn btn-primary">Submit Inquiry</button>
            <button type="button" id="clearBtn" class="btn btn-outline-secondary">Clear</button>
          </div>

          <div id="formAlert" class="mt-3" style="display:none"></div>
        </form>
      </div>
    </div>
  </div>

  <script>
    const INQUIRY_KEY = 'local_inquiries_v1';
    function loadInquiries(){ try { return JSON.parse(localStorage.getItem(INQUIRY_KEY) || '[]'); } catch(e){ return []; } }
    function saveInquiries(list){ localStorage.setItem(INQUIRY_KEY, JSON.stringify(list)); }

    function showAlert(text, type='success'){
      const el = document.getElementById('formAlert');
      el.style.display='block'; el.className = 'alert alert-' + type; el.textContent = text;
      setTimeout(()=>{ el.style.display='none'; }, 5000);
    }

    document.getElementById('inquireForm').addEventListener('submit', function(e){
      e.preventDefault();
      const get = id => document.getElementById(id).value.trim();
      const required = [
        ['p_first','First name'],
        ['p_last','Last name'],
        ['p_phone','Phone number'],
        ['p_address','Address'],
        ['p_dob','Date of birth'],
        ['p_case','Case of patient'],
        ['e_first','Emergency contact first name'],
        ['e_last','Emergency contact last name'],
        ['e_phone','Emergency contact phone'],
        ['e_relation','Emergency contact relation']
      ];
      for(const [id,label] of required){
        if(!get(id)){
          showAlert(label + ' is required', 'danger');
          document.getElementById(id).focus();
          return;
        }
      }

      const inquiry = {
        id: 'inq_' + Date.now() + '_' + Math.floor(Math.random()*9999),
        createdAt: new Date().toISOString(),
        patient: {
          firstName: get('p_first'),
          middleName: get('p_middle'),
          lastName: get('p_last'),
          email: get('p_email'),
          phone: get('p_phone'),
          address: get('p_address'),
          dob: get('p_dob'),
          case: get('p_case')
        },
        emergency: {
          firstName: get('e_first'),
          lastName: get('e_last'),
          email: get('e_email'),
          phone: get('e_phone'),
          relation: get('e_relation')
        },
        status: 'pending'
      };

      const list = loadInquiries();
      list.push(inquiry);
      saveInquiries(list);

      this.reset();
      showAlert('Inquiry submitted. We will contact you soon.', 'success');

      try { localStorage.setItem(INQUIRY_KEY + '_updated_at', Date.now()); } catch(e){}
    });

    document.getElementById('clearBtn').addEventListener('click', function(){
      if(confirm('Clear the form?')) document.getElementById('inquireForm').reset();
    });
  </script>
</body>
</html>